# ansible-elasticsearch-cluster## 部署示例前置条件:```shell#1.下载对应的es程序包wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.17.3-linux-x86_64.tar.gz -O elasticsearch-7.17.3-linux-x86_64.tar.gz#2.使用elasticsearch-certutil命令生成ca证书【默认为elastic-stack-ca.p12】bin/elasticsearch-certutil ca#3.使用elasticsearch-certutil命令生成集群认证证书【默认为elastic-certificates.p12】bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12#4.将程序包、elastic-stack-ca.p12和elastic-certificates.p12文件放到files目录下```清单文件如下所示:```shell#测试环境服务器组[elasticsearch_cluster]elasticsearch-node1    ansible_ssh_host=192.168.0.1    es_http_port=9200    es_transport_port=9300elasticsearch-node2    ansible_ssh_host=192.168.0.2    es_http_port=9200    es_transport_port=9300elasticsearch-node3    ansible_ssh_host=192.168.0.3    es_http_port=9200    es_transport_port=9300[all:vars]ansible_ssh_user=rootansible_ssh_pass='password'ansible_ssh_port=22#ansible_become=true#ansible_become_pass='password'```将该程序clone到ansible rules目录:```shellgit clonemv ansible-elasticsearch-cluster /etc/ansible/roles/elasticsearch-cluster```部署文件如下所示:```shell---- hosts: elasticsearch_cluster  gather_facts: no  vars:    - base_directory: /data/app    - es_start_user: elasticsearch    - es_cluster_name: test-cluster    - es_cluster_hosts: 192.168.0.1,192.168.0.2,192.168.0.3    - es_discovery_seed_hosts_hosts: 192.168.0.1:9300,192.168.0.2:9300,192.168.0.3:9300    - es_cluster_initial_master_nodes: 192.168.0.1:9300,192.168.0.2:9300,192.168.0.3:9300    - es_bootstrap_memory_lock: true    - es_cluster_super_user: logadmin    - es_cluster_super_user_password: password    - es_cluster_memory_small: 4    - es_cluster_memory_max: 4    - es_version: 7.17.3    - os_arch: x86_64  roles:   - role: elasticsearch-cluster```执行部署:```shellansible-playbook -i hosts install.yml```